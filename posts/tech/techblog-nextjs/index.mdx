---
tags: [Next.js, 마크다운, 기술블로그]
thumbnail: 'posts/tech/techblog-nextjs/thumbnail_01.png'
title: 'Next.js로 프리메드 기술 블로그를 만들기까지'
description: '프리메드 기술 블로그가 만들어지기까지 어떤 과정이 있었는지 확인해 볼까요?'
profile: 'posts/tech/techblog-nextjs/profile.png'
author: '김재이 · 사무국'
date: 2024-08-19T12:03:00.000Z
---

안녕하세요! 프리메드 IT팀을 담당하고 있는 사무국의 기술매니저 입니다. 👋🏻

보시다시피 이곳은 프리메드 기술 블로그입니다. 프리메드 IT팀을 단체 내/외부적으로 더 많이 공유하면 좋을 거 같아 시작한 기술 블로그인데요! 첫 포스트를 담당하여 기술 블로그의 과정, 완성 그리고 앞으로의 방향까지 이야기하면서 출발해 보고자 합니다. 🙂

### 📌 먼저, 프리메드 IT팀은 왜 기술 블로그를 만들었을까?

계속해서 변화하고 기술적인 성장을 시도하는 IT팀의 기록을 구체화 하고 알릴 수 있는 방법에 대해 고민하던 중, 우리만의 기술 블로그를 만들어서 거기에서 아카이빙 해볼까? 라는 이야기가 나오면서 시작되었습니다.

<aside>
  <h4>✅ 기술 블로그 목표</h4>
  <ul>
    <li>
      문제 해결 또는 새로운 기술 경험 기록
      <ul>
        <li>전문 지식 및 경험 공유</li>
        <li>주제 회고를 통해 구체적인 이해 및 역량 강화 기대</li>
      </ul>
    </li>
    <li>
      단체 브랜딩 기여
      <ul>
        <li>미래 신입 단원에게 간접적인 어필</li>
        <li>특정 분야 전공자의 검색 유입 기대</li>
      </ul>
    </li>
  </ul>
</aside>

프리메드는 이미 네이버 블로그를 운영하고 있었지만 네이버 블로그는 구글 검색 노출도가 낮았고, 프리메드 기술 분야의 인사이트 및 일하는 방식, 팀 문화를 알리고 싶어 기술 블로그를 자체적으로 만들게 되었습니다.

그럼 기술 블로그 개발기를 시작해 볼게요!

### 📌 기술 블로그에 사용한 기술 스택과 선택한 이유는 무엇일까?

선택한 기술 스택은 아래와 같습니다.

- [**Next.js14**](https://nextjs.org/)
- [**Tailwind CSS**](https://tailwindcss.com/)
- [**MDX**](https://mdxjs.com/)

이 중에서 저희가 가장 중점적으로 논의하였던 부분은 블로그 개발에 가장 많이 쓰이고 있던 React 기반의 웹 프레임워크인 Next.js와 [Gatsby](https://www.gatsbyjs.com/)였습니다. 기술 블로그 기획에 적합하면서 저희에게도 맞는 선택을 하고 싶었기에 중점적으로 논의되었습니다. 그리하여 아래 저희 경험과 각 장단점을 바탕으로 비교해 보았는데요,

<aside>
  <h4>Next.js vs Gatsby</h4>
  <ul>
    <li>
      Gatsby
      <ul>
        <li>
          <strong>프리메드 공식 홈페이지로 경험한 적이 있어</strong> 익숙합니다.
        </li>
        <li>
          <strong>다양한 플러그인 생태계</strong>를 가지고 있어 블로그에 유용한 기능을 빠르게 다룰 수 있습니다.
        </li>
        <li>
          정적 사이트 생성에 중점을 두기 때문에 <strong>제한이 있을 수</strong> 있습니다.
        </li>
      </ul>
    </li>
    <li>
      Next.js
      <ul>
        <li>
          <strong>서버 측 렌더링 및 정적 사이트 생성을 모두 지원</strong>하므로, 프로젝트의 특성에 따라 선택하기
          좋습니다.
        </li>
        <li>
          <strong>React 생태계의 다양한 라이브러리 및 도구</strong>를 쉽게 통합할 수 있습니다.
        </li>
        <li>
          경험해보지 못한 기술 스택이라 <strong>초기 학습비용과 환경 세팅에 시간비용</strong>이 생길 수 있습니다.
        </li>
      </ul>
    </li>
  </ul>
</aside>

결론적으로, 이미 경험이 있고 블로그 개발에는 Gatsby도 충분하다고 생각했지만, Next.js는 현재 많은 개발자들이 사용하고 있으며, 추후 유지보수를 위해 더 많은 부분을 지원해주고 있는 Next.js를 선택하게 되었습니다. 또한 앞으로 나아갈 기술 블로그의 방향성을 생각해서 성장 가능성도 보게 되었습니다 :)

### 📌 그렇다면, 기술 블로그에서 구현하고자 했던 기능은 무엇일까?

블로그 특성상 가장 중요한 기능인

- 포스트 페이지
  - 목록
  - 상세

를 중점적으로 구현하였습니다. 이외 태그, 목차 사이드바, 블로그 확장 등을 고려하여 지속해서 디벨롭해 나갈 예정입니다.

이제 구현했던 과정을 확인해 보려 하는데요, 먼저 포스트 작성을 위한 준비를 합니다.

1. 포스트 작성

   `/posts/tech/hompage-gatsby/index.mdx`
   `/posts/design/rebranding/index.mdx`

   카테고리가 되는 tech와 design으로 폴더링하고 각 제목으로 사용할 폴더를 만들어 `index.mdx` 파일에서 글을 작성하도록 하였습니다. (~~추후 IT팀만이 아닌 프리메드의 다른 분야도 함께할 예정입니다.~~)

   mdx로 선택한 이유는 기본적인 md에서 jsx 문법을 같이 사용하여 컴포넌트를 추가할 수 있어 콘텐츠 관리가 용이하고, 좀 더 다양하고 자유롭게 작성할 수 있을 거 같아 선택하였습니다.

그럼 작성한 포스트 목록을 불러오고 상세를 확인할 수 있는 과정을 확인해 보겠습니다.

2. 포스트 목록 페이지

   지정된 카테고리의 포스트 파일 경로를 가져옵니다.
   mdx 파일의 경로를 추리고 각 file path별로 파싱하는 과정입니다. 주어진 `category` 인 /tech, /design 으로 경로를 찾고, 각 폴더링된 제목을 개발 포스팅, 디자인 포스팅으로 나눠 내용이 보여지게 됩니다.
   모든 포스트 목록을 조회하는 함수는 다음과 같이 작성하였습니다.

   ```tsx {showLineNumbers}
   const BASE_PATH = '/posts'
   const POSTS_PATH = path.join(process.cwd(), BASE_PATH)

   export const getPostPaths = (category?: string) => {
     const folder = category || '**'
     const postPaths: string[] = sync(`${POSTS_PATH}/${folder}/**/*.mdx`)
     return postPaths
   }

   export const getPostList = async (category?: string): Promise<Post[]> => {
     const postPaths = getPostPaths(category)
     const postList = await Promise.all(postPaths.map(postPath => parsePost(postPath)))
     return sortPostList(postList)
   }
   ```

3. 포스트 상세 페이지

   상세는 파싱 정보 객체 한가지를 가공해서 HTML, 즉 UI로 변환하여 보여주게 됩니다.

   `getPostPaths()` 함수를 호출하여 모든 게시물 경로를 가져오고 각 경로에 대해 `parsePost(path)` 함수를 호출하여 게시물의 세부 정보를 파싱합니다.

   ```tsx {showLineNumbers}
   export async function generateStaticParams() {
     const postPaths: string[] = getPostPaths()
     const paramList = await Promise.all(
       postPaths.map(async path => {
         const post = await parsePost(path)
         return { category: post.categoryPath, slug: post.slug }
       })
     )
     return paramList
   }
   ```

   포스트 상세를 파싱하고 조회하는 함수는 다음과 같이 작성하였습니다.

   ```tsx {showLineNumbers}
   export const parsePost = async (postPath: string): Promise<Post> => {
     const filePath = postPath.slice(postPath.indexOf(BASE_PATH)).replace(`${BASE_PATH}/`, '').replace('.mdx', '')
     const [categoryPath, slug] = filePath.split('/')
     const url = `/${categoryPath}/${slug}`
     const file = fs.readFileSync(postPath, 'utf8')
     const { data, content } = matter(file)
     const grayMatter = data as PostMatter
     return {
       url,
       categoryPath,
       slug,
       ...grayMatter,
       content,
     }
   }

   export const getPostDetail = async (category: string, slug: string) => {
     const filePath = `${POSTS_PATH}/${category}/${slug}/index.mdx`
     const detail = await parsePost(filePath)
     return detail
   }
   ```

   이때 마크다운을 저장된 index에서 HTML로 변환을 해주어야 하는데 여기서는 [next-mdx-remote](https://github.com/hashicorp/next-mdx-remote#react-server-components-rsc--nextjs-app-directory-support)를 사용하였습니다.

   파싱했던 `index`를 props로, 원하는 mdx plugin을 함께 전달해 주었습니다.

   ```tsx {showLineNumbers}
   import { Post } from '@/config/types'
   import { MDXRemote } from 'next-mdx-remote/rsc'
   import rehypePrettyCode from 'rehype-pretty-code'
   import rehypeSlug from 'rehype-slug'
   import remarkBreaks from 'remark-breaks'
   import remarkGfm from 'remark-gfm'
   import { MdxComponents } from '../mdx'

   interface Props {
     post: Post
   }

   const PostBody = ({ post }: Props) => {
     return (
       <MDXRemote
         source={post.content}
         options={{
           mdxOptions: {
             remarkPlugins: [remarkGfm, remarkBreaks],
             rehypePlugins: [
               [
                 rehypePrettyCode,
                 {
                   theme: { dark: 'github-dark-dimmed', light: 'github-light' },
                 },
               ],
             ],
           },
         }}
         components={MdxComponents}
       />
     )
   }

   export default PostBody
   ```

   마크다운 플러그인은

   - remark plugins
     - remarkGfm : 깃허브 Flavored 마크다운 지원
     - remarkBreaks : markdown 한 줄로 개행
   - rehype plugins
     - [**rehypePrettyCode**](https://rehype-pretty-code.netlify.app/) : 코드블록 커스텀

   을 사용했습니다. 이렇게 포스트 상세까지 불러오는 과정을 완료하였습니다.
   더 자세한 코드는 [프리메드 기술 블로그 저장소](https://github.com/freemed-it/techblog)에서 보실 수 있어요!

### 📌 그런데, 개발하면서 마주한 이슈는 무엇이며 해결은 어떻게 했을까?

개발하면서 여러 가지 이슈들을 접하게 되었는데요, 그중에 몇 가지만 정리해 보았습니다.

1. **정적 페이지 배포 시 `next.config.js` 에서 일어난 이슈**
   - **trailingSlash: true**
     - trailingSlash는 URL 주소 끝에 붙은 슬래시 `/` 를 말합니다.
     - Next.js는 output: 'export' 옵션으로 /index.html 경로로 추출됩니다. 예를 들어 `/index.html/`은 `/index.html` 으로 넘어가게 되고 두 경로를 다르게 인식하여 불러오지 못합니다.
     - 따라서 페이지 이동 시 맨 뒤에 / 붙여서 리다이렉트가 필요합니다.
     - 이는 next.config.js에 `trailingSlash: true` 옵션을 추가해 해결할 수 있습니다.

다음은 Next.js 관련해서 알아두면 좋을 내용입니다!

1. **"output": "export”**

   - Next.js14부터 next export를 사용할 수 없기 때문에 next.config.js에 **`"output": "export”`** 를 넣어 사용해 주어야 합니다.

   ```jsx {showLineNumbers}
   ...(process.env.NODE_ENV === 'production' && {
   output: 'export',
   }),
   ```

2. **Image 태그 src 경로에 `/`부터 시작해서 public 폴더에 위치한 이미지 경로로 작성**
   - public 폴더 파일은 빌드 시 루트 경로에 위치하게 됩니다.
   - `/` 를 붙이지 않으면 (trailingSlash 여부와 상관 없이) 루트 경로가 아닌 페이지에서 뜨지 않습니다.
   - 따라서 `<Image src=’/logo.svg’ />` 로 경로를 써주어야 합니다.

마지막으로 http 환경에서 url 복사를 위한 navigator.clipboard API가 작동하지 않는 이슈가 있었습니다. navigator.clipboard는 localhost 혹은 https 환경에서만 동작하기 때문에 보안상의 이유로 안전한 연결을 통해서만 클립보드에 접근할 수 있었습니다.

### 📌 그리하여, 만들어진 프리메드 기술 블로그

기획부터 디자인, 개발까지 저희 힘으로 해낸 기술 블로그가 완성되었습니다!
지금처럼 새로운 기술과 트렌드가 끊임없이 발전하는 시대에, 다양한 기술과 저희의 경험을 공유하면서 프리메드 기술 블로그가 공동체의 일부로서 함께 발전할 수 있게 여러 가지 시도를 해볼 생각입니다! 카테고리 확장, 태그 기능, 더 나아가 블로그 자체로 확장까지 더 넓은 기술 블로그를 만들어 나갈 수 있으면 좋을 거 같아요.

### 📌 글을 마치며

기술 블로그를 만들면서 Next.js에 가까워진 거 같아 좋은 경험이었습니다. 좀 더 배워야 할 것들도 눈에 보이면서 여러 가지로 공부가 되었어요! 앞으로 프리메드 기술 블로그에 저희가 배운 것들, 만들어 나간 것들을 꾸준히 기록해 나가면서 경험을 공유하고 소통할 수 있으면 좋을 거 같아요.
기술 블로그를 통해 지식의 나눔과 협력을 통해 더 나은 개발자로 성장해 보는 기대도 가지고 있습니다!
앞으로가 더 기대되는 프리메드 기술 블로그 많은 관심 부탁드립니다. 😊

> 기술 블로그 개발에 많은 참고가 되어준 https://d5br5.dev/blog 감사드립니다!
